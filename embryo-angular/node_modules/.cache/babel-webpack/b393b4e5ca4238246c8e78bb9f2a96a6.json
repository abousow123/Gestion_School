{"ast":null,"code":"var _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _slicedToArray = function () {\n  function sliceIterator(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i[\"return\"]) _i[\"return\"]();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  return function (arr, i) {\n    if (Array.isArray(arr)) {\n      return arr;\n    } else if (Symbol.iterator in Object(arr)) {\n      return sliceIterator(arr, i);\n    } else {\n      throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n    }\n  };\n}();\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _objectWithoutProperties(obj, keys) {\n  var target = {};\n\n  for (var i in obj) {\n    if (keys.indexOf(i) >= 0) continue;\n    if (!Object.prototype.hasOwnProperty.call(obj, i)) continue;\n    target[i] = obj[i];\n  }\n\n  return target;\n}\n\nimport find from 'lodash/find';\nimport isEqual from 'lodash/isEqual';\nimport { checkRendering, warn } from '../../lib/utils.js';\nvar usage = 'Usage:\\nvar customHierarchicalMenu = connectHierarchicalMenu(function renderFn(params, isFirstRendering) {\\n  // params = {\\n  //   createURL,\\n  //   items,\\n  //   refine,\\n  //   instantSearchInstance,\\n  //   widgetParams,\\n  // }\\n});\\nsearch.addWidget(\\n  customHierarchicalMenu({\\n    attributes,\\n    [ separator = \\' > \\' ],\\n    [ rootPath = null ],\\n    [ showParentLevel = true ],\\n    [ limit = 10 ],\\n    [ sortBy = [\\'name:asc\\'] ],\\n    [ transformItems ],\\n  })\\n);\\nFull documentation available at https://community.algolia.com/instantsearch.js/v2/connectors/connectHierarchicalMenu.html\\n';\n/**\n * @typedef {Object} HierarchicalMenuItem\n * @property {string} value Value of the menu item.\n * @property {string} label Human-readable value of the menu item.\n * @property {number} count Number of matched results after refinement is applied.\n * @property {isRefined} boolean Indicates if the refinement is applied.\n * @property {Object} [data = undefined] n+1 level of items, same structure HierarchicalMenuItem (default: `undefined`).\n */\n\n/**\n * @typedef {Object} CustomHierarchicalMenuWidgetOptions\n * @property {string[]} attributes Attributes to use to generate the hierarchy of the menu.\n * @property {string} [separator = '>'] Separator used in the attributes to separate level values.\n * @property {string} [rootPath = null] Prefix path to use if the first level is not the root level.\n * @property {boolean} [showParentLevel=false] Show the siblings of the selected parent levels of the current refined value. This\n * does not impact the root level.\n * @property {number} [limit = 10] Max number of value to display.\n * @property  {string[]|function} [sortBy = ['name:asc']] How to sort refinements. Possible values: `count|isRefined|name:asc|name:desc`.\n *\n * You can also use a sort function that behaves like the standard Javascript [compareFunction](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort#Syntax).\n * @property {function(object[]):object[]} [transformItems] Function to transform the items passed to the templates.\n */\n\n/**\n * @typedef {Object} HierarchicalMenuRenderingOptions\n * @property {function(item.value): string} createURL Creates an url for the next state for a clicked item.\n * @property {HierarchicalMenuItem[]} items Values to be rendered.\n * @property {function(item.value)} refine Sets the path of the hierarchical filter and triggers a new search.\n * @property {Object} widgetParams All original `CustomHierarchicalMenuWidgetOptions` forwarded to the `renderFn`.\n */\n\n/**\n * **HierarchicalMenu** connector provides the logic to build a custom widget\n * that will give the user the ability to explore facets in a tree-like structure.\n *\n * This is commonly used for multi-level categorization of products on e-commerce\n * websites. From a UX point of view, we suggest not displaying more than two\n * levels deep.\n *\n * There's a complete example available on how to write a custom **HierarchicalMenu**:\n *  [hierarchicalMenu.js](https://github.com/algolia/instantsearch.js/blob/develop/dev/app/jquery/widgets/hierarchicalMenu.js)\n * @type {Connector}\n * @canonical https://www.algolia.com/doc/api-reference/widgets/hierarchical-menu/js/\n * @param {function(HierarchicalMenuRenderingOptions)} renderFn Rendering function for the custom **HierarchicalMenu** widget.\n * @param {function} unmountFn Unmount function called when the widget is disposed.\n * @return {function(CustomHierarchicalMenuWidgetOptions)} Re-usable widget factory for a custom **HierarchicalMenu** widget.\n */\n\nexport default function connectHierarchicalMenu(renderFn, unmountFn) {\n  checkRendering(renderFn, usage);\n  return function () {\n    var widgetParams = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var attributes = widgetParams.attributes,\n        _widgetParams$separat = widgetParams.separator,\n        separator = _widgetParams$separat === undefined ? ' > ' : _widgetParams$separat,\n        _widgetParams$rootPat = widgetParams.rootPath,\n        rootPath = _widgetParams$rootPat === undefined ? null : _widgetParams$rootPat,\n        _widgetParams$showPar = widgetParams.showParentLevel,\n        showParentLevel = _widgetParams$showPar === undefined ? true : _widgetParams$showPar,\n        _widgetParams$limit = widgetParams.limit,\n        limit = _widgetParams$limit === undefined ? 10 : _widgetParams$limit,\n        _widgetParams$sortBy = widgetParams.sortBy,\n        sortBy = _widgetParams$sortBy === undefined ? ['name:asc'] : _widgetParams$sortBy,\n        _widgetParams$transfo = widgetParams.transformItems,\n        transformItems = _widgetParams$transfo === undefined ? function (items) {\n      return items;\n    } : _widgetParams$transfo;\n\n    if (!attributes || !attributes.length) {\n      throw new Error(usage);\n    } // we need to provide a hierarchicalFacet name for the search state\n    // so that we can always map $hierarchicalFacetName => real attributes\n    // we use the first attribute name\n\n\n    var _attributes = _slicedToArray(attributes, 1),\n        hierarchicalFacetName = _attributes[0];\n\n    return {\n      getConfiguration: function getConfiguration(currentConfiguration) {\n        if (currentConfiguration.hierarchicalFacets) {\n          var isFacetSet = find(currentConfiguration.hierarchicalFacets, function (_ref) {\n            var name = _ref.name;\n            return name === hierarchicalFacetName;\n          });\n\n          if (isFacetSet && !(isEqual(isFacetSet.attributes, attributes) && isFacetSet.separator === separator)) {\n            warn('using Breadcrumb & HierarchicalMenu on the same facet with different options');\n            return {};\n          }\n        }\n\n        return {\n          hierarchicalFacets: [{\n            name: hierarchicalFacetName,\n            attributes: attributes,\n            separator: separator,\n            rootPath: rootPath,\n            showParentLevel: showParentLevel\n          }],\n          maxValuesPerFacet: currentConfiguration.maxValuesPerFacet !== undefined ? Math.max(currentConfiguration.maxValuesPerFacet, limit) : limit\n        };\n      },\n      init: function init(_ref2) {\n        var helper = _ref2.helper,\n            createURL = _ref2.createURL,\n            instantSearchInstance = _ref2.instantSearchInstance;\n\n        this._refine = function (facetValue) {\n          helper.toggleRefinement(hierarchicalFacetName, facetValue).search();\n        }; // Bind createURL to this specific attribute\n\n\n        function _createURL(facetValue) {\n          return createURL(helper.state.toggleRefinement(hierarchicalFacetName, facetValue));\n        }\n\n        renderFn({\n          createURL: _createURL,\n          items: [],\n          refine: this._refine,\n          instantSearchInstance: instantSearchInstance,\n          widgetParams: widgetParams\n        }, true);\n      },\n      _prepareFacetValues: function _prepareFacetValues(facetValues, state) {\n        var _this = this;\n\n        return facetValues.slice(0, limit).map(function (_ref3) {\n          var label = _ref3.name,\n              value = _ref3.path,\n              subValue = _objectWithoutProperties(_ref3, ['name', 'path']);\n\n          if (Array.isArray(subValue.data)) {\n            subValue.data = _this._prepareFacetValues(subValue.data, state);\n          }\n\n          return _extends({}, subValue, {\n            label: label,\n            value: value\n          });\n        });\n      },\n      render: function render(_ref4) {\n        var results = _ref4.results,\n            state = _ref4.state,\n            createURL = _ref4.createURL,\n            instantSearchInstance = _ref4.instantSearchInstance;\n        var items = transformItems(this._prepareFacetValues(results.getFacetValues(hierarchicalFacetName, {\n          sortBy: sortBy\n        }).data || [], state)); // Bind createURL to this specific attribute\n\n        function _createURL(facetValue) {\n          return createURL(state.toggleRefinement(hierarchicalFacetName, facetValue));\n        }\n\n        renderFn({\n          createURL: _createURL,\n          items: items,\n          refine: this._refine,\n          instantSearchInstance: instantSearchInstance,\n          widgetParams: widgetParams\n        }, false);\n      },\n      dispose: function dispose(_ref5) {\n        var state = _ref5.state; // unmount widget from DOM\n\n        unmountFn(); // compute nextState for the search\n\n        var nextState = state;\n\n        if (state.isHierarchicalFacetRefined(hierarchicalFacetName)) {\n          nextState = state.removeHierarchicalFacetRefinement(hierarchicalFacetName);\n        }\n\n        nextState = nextState.removeHierarchicalFacet(hierarchicalFacetName);\n\n        if (nextState.maxValuesPerFacet === limit) {\n          nextState.setQueryParameters('maxValuesPerFacet', undefined);\n        }\n\n        return nextState;\n      },\n      getWidgetState: function getWidgetState(uiState, _ref6) {\n        var searchParameters = _ref6.searchParameters;\n        var path = searchParameters.getHierarchicalFacetBreadcrumb(hierarchicalFacetName);\n        if (!path || path.length === 0) return uiState;\n\n        if (uiState.hierarchicalMenu && isEqual(path, uiState.hierarchicalMenu[hierarchicalFacetName])) {\n          return uiState;\n        }\n\n        return _extends({}, uiState, {\n          hierarchicalMenu: _extends({}, uiState.hierarchicalMenu, _defineProperty({}, hierarchicalFacetName, path))\n        });\n      },\n      getWidgetSearchParameters: function getWidgetSearchParameters(searchParameters, _ref7) {\n        var uiState = _ref7.uiState;\n\n        if (uiState.hierarchicalMenu && uiState.hierarchicalMenu[hierarchicalFacetName]) {\n          return searchParameters.clearRefinements(hierarchicalFacetName).toggleRefinement(hierarchicalFacetName, uiState.hierarchicalMenu[hierarchicalFacetName].join(separator));\n        } else {\n          return searchParameters;\n        }\n      }\n    };\n  };\n}","map":{"version":3,"sources":["/home/sow/Bureau/ProjetPerso/Gestion_School/embryo-angular/node_modules/instantsearch.js/es/connectors/hierarchical-menu/connectHierarchicalMenu.js"],"names":["_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","_slicedToArray","sliceIterator","arr","_arr","_n","_d","_e","undefined","_i","Symbol","iterator","_s","next","done","push","value","err","Array","isArray","TypeError","_defineProperty","obj","defineProperty","enumerable","configurable","writable","_objectWithoutProperties","keys","indexOf","find","isEqual","checkRendering","warn","usage","connectHierarchicalMenu","renderFn","unmountFn","widgetParams","attributes","_widgetParams$separat","separator","_widgetParams$rootPat","rootPath","_widgetParams$showPar","showParentLevel","_widgetParams$limit","limit","_widgetParams$sortBy","sortBy","_widgetParams$transfo","transformItems","items","Error","_attributes","hierarchicalFacetName","getConfiguration","currentConfiguration","hierarchicalFacets","isFacetSet","_ref","name","maxValuesPerFacet","Math","max","init","_ref2","helper","createURL","instantSearchInstance","_refine","facetValue","toggleRefinement","search","_createURL","state","refine","_prepareFacetValues","facetValues","_this","slice","map","_ref3","label","path","subValue","data","render","_ref4","results","getFacetValues","dispose","_ref5","nextState","isHierarchicalFacetRefined","removeHierarchicalFacetRefinement","removeHierarchicalFacet","setQueryParameters","getWidgetState","uiState","_ref6","searchParameters","getHierarchicalFacetBreadcrumb","hierarchicalMenu","getWidgetSearchParameters","_ref7","clearRefinements","join"],"mappings":"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","sourcesContent":["var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\nimport find from 'lodash/find';\nimport isEqual from 'lodash/isEqual';\n\nimport { checkRendering, warn } from '../../lib/utils.js';\n\nvar usage = 'Usage:\\nvar customHierarchicalMenu = connectHierarchicalMenu(function renderFn(params, isFirstRendering) {\\n  // params = {\\n  //   createURL,\\n  //   items,\\n  //   refine,\\n  //   instantSearchInstance,\\n  //   widgetParams,\\n  // }\\n});\\nsearch.addWidget(\\n  customHierarchicalMenu({\\n    attributes,\\n    [ separator = \\' > \\' ],\\n    [ rootPath = null ],\\n    [ showParentLevel = true ],\\n    [ limit = 10 ],\\n    [ sortBy = [\\'name:asc\\'] ],\\n    [ transformItems ],\\n  })\\n);\\nFull documentation available at https://community.algolia.com/instantsearch.js/v2/connectors/connectHierarchicalMenu.html\\n';\n\n/**\n * @typedef {Object} HierarchicalMenuItem\n * @property {string} value Value of the menu item.\n * @property {string} label Human-readable value of the menu item.\n * @property {number} count Number of matched results after refinement is applied.\n * @property {isRefined} boolean Indicates if the refinement is applied.\n * @property {Object} [data = undefined] n+1 level of items, same structure HierarchicalMenuItem (default: `undefined`).\n */\n\n/**\n * @typedef {Object} CustomHierarchicalMenuWidgetOptions\n * @property {string[]} attributes Attributes to use to generate the hierarchy of the menu.\n * @property {string} [separator = '>'] Separator used in the attributes to separate level values.\n * @property {string} [rootPath = null] Prefix path to use if the first level is not the root level.\n * @property {boolean} [showParentLevel=false] Show the siblings of the selected parent levels of the current refined value. This\n * does not impact the root level.\n * @property {number} [limit = 10] Max number of value to display.\n * @property  {string[]|function} [sortBy = ['name:asc']] How to sort refinements. Possible values: `count|isRefined|name:asc|name:desc`.\n *\n * You can also use a sort function that behaves like the standard Javascript [compareFunction](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort#Syntax).\n * @property {function(object[]):object[]} [transformItems] Function to transform the items passed to the templates.\n */\n\n/**\n * @typedef {Object} HierarchicalMenuRenderingOptions\n * @property {function(item.value): string} createURL Creates an url for the next state for a clicked item.\n * @property {HierarchicalMenuItem[]} items Values to be rendered.\n * @property {function(item.value)} refine Sets the path of the hierarchical filter and triggers a new search.\n * @property {Object} widgetParams All original `CustomHierarchicalMenuWidgetOptions` forwarded to the `renderFn`.\n */\n\n/**\n * **HierarchicalMenu** connector provides the logic to build a custom widget\n * that will give the user the ability to explore facets in a tree-like structure.\n *\n * This is commonly used for multi-level categorization of products on e-commerce\n * websites. From a UX point of view, we suggest not displaying more than two\n * levels deep.\n *\n * There's a complete example available on how to write a custom **HierarchicalMenu**:\n *  [hierarchicalMenu.js](https://github.com/algolia/instantsearch.js/blob/develop/dev/app/jquery/widgets/hierarchicalMenu.js)\n * @type {Connector}\n * @canonical https://www.algolia.com/doc/api-reference/widgets/hierarchical-menu/js/\n * @param {function(HierarchicalMenuRenderingOptions)} renderFn Rendering function for the custom **HierarchicalMenu** widget.\n * @param {function} unmountFn Unmount function called when the widget is disposed.\n * @return {function(CustomHierarchicalMenuWidgetOptions)} Re-usable widget factory for a custom **HierarchicalMenu** widget.\n */\nexport default function connectHierarchicalMenu(renderFn, unmountFn) {\n  checkRendering(renderFn, usage);\n\n  return function () {\n    var widgetParams = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var attributes = widgetParams.attributes,\n        _widgetParams$separat = widgetParams.separator,\n        separator = _widgetParams$separat === undefined ? ' > ' : _widgetParams$separat,\n        _widgetParams$rootPat = widgetParams.rootPath,\n        rootPath = _widgetParams$rootPat === undefined ? null : _widgetParams$rootPat,\n        _widgetParams$showPar = widgetParams.showParentLevel,\n        showParentLevel = _widgetParams$showPar === undefined ? true : _widgetParams$showPar,\n        _widgetParams$limit = widgetParams.limit,\n        limit = _widgetParams$limit === undefined ? 10 : _widgetParams$limit,\n        _widgetParams$sortBy = widgetParams.sortBy,\n        sortBy = _widgetParams$sortBy === undefined ? ['name:asc'] : _widgetParams$sortBy,\n        _widgetParams$transfo = widgetParams.transformItems,\n        transformItems = _widgetParams$transfo === undefined ? function (items) {\n      return items;\n    } : _widgetParams$transfo;\n\n\n    if (!attributes || !attributes.length) {\n      throw new Error(usage);\n    }\n\n    // we need to provide a hierarchicalFacet name for the search state\n    // so that we can always map $hierarchicalFacetName => real attributes\n    // we use the first attribute name\n\n    var _attributes = _slicedToArray(attributes, 1),\n        hierarchicalFacetName = _attributes[0];\n\n    return {\n      getConfiguration: function getConfiguration(currentConfiguration) {\n        if (currentConfiguration.hierarchicalFacets) {\n          var isFacetSet = find(currentConfiguration.hierarchicalFacets, function (_ref) {\n            var name = _ref.name;\n            return name === hierarchicalFacetName;\n          });\n          if (isFacetSet && !(isEqual(isFacetSet.attributes, attributes) && isFacetSet.separator === separator)) {\n            warn('using Breadcrumb & HierarchicalMenu on the same facet with different options');\n            return {};\n          }\n        }\n\n        return {\n          hierarchicalFacets: [{\n            name: hierarchicalFacetName,\n            attributes: attributes,\n            separator: separator,\n            rootPath: rootPath,\n            showParentLevel: showParentLevel\n          }],\n          maxValuesPerFacet: currentConfiguration.maxValuesPerFacet !== undefined ? Math.max(currentConfiguration.maxValuesPerFacet, limit) : limit\n        };\n      },\n\n      init: function init(_ref2) {\n        var helper = _ref2.helper,\n            createURL = _ref2.createURL,\n            instantSearchInstance = _ref2.instantSearchInstance;\n\n        this._refine = function (facetValue) {\n          helper.toggleRefinement(hierarchicalFacetName, facetValue).search();\n        };\n\n        // Bind createURL to this specific attribute\n        function _createURL(facetValue) {\n          return createURL(helper.state.toggleRefinement(hierarchicalFacetName, facetValue));\n        }\n\n        renderFn({\n          createURL: _createURL,\n          items: [],\n          refine: this._refine,\n          instantSearchInstance: instantSearchInstance,\n          widgetParams: widgetParams\n        }, true);\n      },\n      _prepareFacetValues: function _prepareFacetValues(facetValues, state) {\n        var _this = this;\n\n        return facetValues.slice(0, limit).map(function (_ref3) {\n          var label = _ref3.name,\n              value = _ref3.path,\n              subValue = _objectWithoutProperties(_ref3, ['name', 'path']);\n\n          if (Array.isArray(subValue.data)) {\n            subValue.data = _this._prepareFacetValues(subValue.data, state);\n          }\n          return _extends({}, subValue, { label: label, value: value });\n        });\n      },\n      render: function render(_ref4) {\n        var results = _ref4.results,\n            state = _ref4.state,\n            createURL = _ref4.createURL,\n            instantSearchInstance = _ref4.instantSearchInstance;\n\n        var items = transformItems(this._prepareFacetValues(results.getFacetValues(hierarchicalFacetName, { sortBy: sortBy }).data || [], state));\n\n        // Bind createURL to this specific attribute\n        function _createURL(facetValue) {\n          return createURL(state.toggleRefinement(hierarchicalFacetName, facetValue));\n        }\n\n        renderFn({\n          createURL: _createURL,\n          items: items,\n          refine: this._refine,\n          instantSearchInstance: instantSearchInstance,\n          widgetParams: widgetParams\n        }, false);\n      },\n      dispose: function dispose(_ref5) {\n        var state = _ref5.state;\n\n        // unmount widget from DOM\n        unmountFn();\n\n        // compute nextState for the search\n        var nextState = state;\n\n        if (state.isHierarchicalFacetRefined(hierarchicalFacetName)) {\n          nextState = state.removeHierarchicalFacetRefinement(hierarchicalFacetName);\n        }\n\n        nextState = nextState.removeHierarchicalFacet(hierarchicalFacetName);\n\n        if (nextState.maxValuesPerFacet === limit) {\n          nextState.setQueryParameters('maxValuesPerFacet', undefined);\n        }\n\n        return nextState;\n      },\n      getWidgetState: function getWidgetState(uiState, _ref6) {\n        var searchParameters = _ref6.searchParameters;\n\n        var path = searchParameters.getHierarchicalFacetBreadcrumb(hierarchicalFacetName);\n        if (!path || path.length === 0) return uiState;\n        if (uiState.hierarchicalMenu && isEqual(path, uiState.hierarchicalMenu[hierarchicalFacetName])) {\n          return uiState;\n        }\n\n        return _extends({}, uiState, {\n          hierarchicalMenu: _extends({}, uiState.hierarchicalMenu, _defineProperty({}, hierarchicalFacetName, path))\n        });\n      },\n      getWidgetSearchParameters: function getWidgetSearchParameters(searchParameters, _ref7) {\n        var uiState = _ref7.uiState;\n\n        if (uiState.hierarchicalMenu && uiState.hierarchicalMenu[hierarchicalFacetName]) {\n          return searchParameters.clearRefinements(hierarchicalFacetName).toggleRefinement(hierarchicalFacetName, uiState.hierarchicalMenu[hierarchicalFacetName].join(separator));\n        } else {\n          return searchParameters;\n        }\n      }\n    };\n  };\n}"]},"metadata":{},"sourceType":"module"}